<purpose>
Выявить предположения Claude о фазе перед планированием, позволяя пользователям исправить заблуждения на ранней стадии.

Ключевое отличие от discuss-phase: Это АНАЛИЗ того, что думает Claude, а не СБОР информации от пользователя. Без файлового вывода — чисто разговорный формат для стимулирования обсуждения.
</purpose>

<process>

<step name="validate_phase" priority="first">
Номер фазы: $ARGUMENTS (обязательно)

**Если аргумент отсутствует:**

```
Ошибка: Требуется номер фазы.

Использование: /gsd:list-phase-assumptions [номер-фазы]
Пример: /gsd:list-phase-assumptions 3
```

Выход из рабочего процесса.

**Если аргумент указан:**
Проверьте существование фазы в дорожной карте:

```bash
cat .planning/ROADMAP.md | grep -i "Phase ${PHASE}"
```

**Если фаза не найдена:**

```
Ошибка: Фаза ${PHASE} не найдена в дорожной карте.

Доступные фазы:
[список фаз из дорожной карты]
```

Выход из рабочего процесса.

**Если фаза найдена:**
Распарсите детали фазы из дорожной карты:

- Номер фазы
- Название фазы
- Описание/цель фазы
- Упомянутые детали области охвата

Перейти к analyze_phase.
</step>

<step name="analyze_phase">
На основе описания в дорожной карте и контекста проекта определите предположения в пяти областях:

**1. Технический подход:**
Какие библиотеки, фреймворки, паттерны или инструменты Claude будет использовать?
- "Я бы использовал библиотеку X, потому что..."
- "Я бы следовал паттерну Y, потому что..."
- "Я бы структурировал это как Z, потому что..."

**2. Порядок реализации:**
Что Claude построил бы первым, вторым, третьим?
- "Я бы начал с X, потому что это фундамент"
- "Затем Y, потому что зависит от X"
- "Наконец Z, потому что..."

**3. Границы области охвата:**
Что включено, а что исключено в интерпретации Claude?
- "Эта фаза включает: A, B, C"
- "Эта фаза НЕ включает: D, E, F"
- "Неоднозначности границ: G может быть в любую сторону"

**4. Области рисков:**
Где Claude ожидает сложности или проблемы?
- "Сложная часть — это X, потому что..."
- "Потенциальные проблемы: Y, Z"
- "Следует обратить внимание на..."

**5. Зависимости:**
Что Claude предполагает существующим или необходимым?
- "Это предполагает X из предыдущих фаз"
- "Внешние зависимости: Y, Z"
- "Это будет использоваться для..."

Будьте честны в отношении неопределённости. Отмечайте предположения уровнями уверенности:
- "Достаточно уверен: ..." (ясно из дорожной карты)
- "Предполагаю: ..." (разумный вывод)
- "Неясно: ..." (может пойти несколькими путями)
</step>

<step name="present_assumptions">
Представьте предположения в ясном, легко сканируемом формате:

```
## Мои предположения для Фазы ${PHASE}: ${PHASE_NAME}

### Технический подход
[Перечислите предположения о способе реализации]

### Порядок реализации
[Перечислите предположения о последовательности]

### Границы области охвата
**В области:** [что включено]
**Вне области:** [что исключено]
**Неоднозначно:** [что может быть в обе стороны]

### Области рисков
[Перечислите ожидаемые трудности]

### Зависимости
**Из предыдущих фаз:** [что необходимо]
**Внешние:** [сторонние потребности]
**Питает:** [что будущие фазы нуждаются от этой]

---

**Что вы думаете?**

Эти предположения верны? Дайте знать:
- Что я угадал правильно
- Что я угадал неправильно
- Что я упускаю
```

Ожидайте ответа пользователя.
</step>

<step name="gather_feedback">
**Если пользователь предоставляет исправления:**

Подтвердите исправления:

```
Ключевые исправления:
- [исправление 1]
- [исправление 2]

Это существенно меняет моё понимание. [Резюмируйте новое понимание]
```

**Если пользователь подтверждает предположения:**

```
Предположения подтверждены.
```

Перейти к offer_next.
</step>

<step name="offer_next">
Предложите следующие шаги:

```
Что дальше?
1. Обсудить контекст (/gsd:discuss-phase ${PHASE}) — Позвольте мне задать вам вопросы для построения всестороннего контекста
2. Планировать эту фазу (/gsd:plan-phase ${PHASE}) — Создать детальные планы выполнения
3. Пересмотреть предположения — Я проанализирую заново с вашими исправлениями
4. Пока закончили
```

Ожидайте выбора пользователя.

Если "Обсудить контекст": Отметить, что CONTEXT.md включит все обсуждённые исправления
Если "Планировать эту фазу": Продолжить, зная что предположения поняты
Если "Пересмотреть": Вернуться к analyze_phase с обновлённым пониманием
</step>

</process>

<success_criteria>
- Номер фазы проверен по дорожной карте
- Предположения выявлены в пяти областях: технический подход, порядок реализации, область охвата, риски, зависимости
- Уровни уверенности отмечены где уместно
- Представлен вопрос "Что вы думаете?"
- Обратная связь пользователя учтена
- Предложены чёткие следующие шаги
</success_criteria>
