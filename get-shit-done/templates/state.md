# Шаблон состояния

Шаблон для `.planning/STATE.md` — живая память проекта.

---

## Шаблон файла

```markdown
# Состояние проекта

## Ссылка на проект

См.: .planning/PROJECT.md (обновлено [дата])

**Ключевая ценность:** [Однострочник из раздела Ключевая ценность PROJECT.md]
**Текущий фокус:** [Название текущей фазы]

## Текущая позиция

Фаза: [X] из [Y] ([Название фазы])
План: [A] из [B] в текущей фазе
Статус: [Готов к планированию / Планирование / Готов к выполнению / В работе / Фаза завершена]
Последняя активность: [ГГГГ-ММ-ДД] — [Что произошло]

Прогресс: [░░░░░░░░░░] 0%

## Метрики производительности

**Скорость:**
- Всего планов выполнено: [N]
- Среднее время: [X] мин
- Общее время выполнения: [X.X] часов

**По фазам:**

| Фаза | Планы | Всего | Ср./План |
|------|-------|-------|----------|
| - | - | - | - |

**Последний тренд:**
- Последние 5 планов: [длительности]
- Тренд: [Улучшается / Стабильный / Ухудшается]

*Обновляется после завершения каждого плана*

## Накопленный контекст

### Решения

Решения логируются в таблице Ключевых решений PROJECT.md.
Последние решения, влияющие на текущую работу:

- [Фаза X]: [Краткое описание решения]
- [Фаза Y]: [Краткое описание решения]

### Отложенные задачи

[Из .planning/todos/pending/ — идеи, зафиксированные во время сессий]

Пока нет.

### Блокеры/Проблемы

[Вопросы, влияющие на будущую работу]

Пока нет.

## Непрерывность сессий

Последняя сессия: [ГГГГ-ММ-ДД ЧЧ:ММ]
Остановились на: [Описание последнего выполненного действия]
Файл возобновления: [Путь к .continue-here*.md если существует, иначе "Нет"]
```

<purpose>

STATE.md — это краткосрочная память проекта, охватывающая все фазы и сессии.

**Проблема, которую решает:** Информация захватывается в итогах, задачах и решениях, но не потребляется систематически. Сессии начинаются без контекста.

**Решение:** Единый небольшой файл, который:
- Читается первым в каждом рабочем процессе
- Обновляется после каждого значимого действия
- Содержит дайджест накопленного контекста
- Позволяет мгновенно восстановить сессию

</purpose>

<lifecycle>

**Создание:** После создания ROADMAP.md (во время init)
- Ссылка на PROJECT.md (прочитать его для текущего контекста)
- Инициализировать пустые разделы накопленного контекста
- Установить позицию "Фаза 1 готова к планированию"

**Чтение:** Первый шаг каждого рабочего процесса
- progress: Показать статус пользователю
- plan: Информировать решения планирования
- execute: Знать текущую позицию
- transition: Знать что завершено

**Запись:** После каждого значимого действия
- execute: После создания SUMMARY.md
  - Обновить позицию (фаза, план, статус)
  - Отметить новые решения (детали в PROJECT.md)
  - Добавить блокеры/проблемы
- transition: После отметки фазы как завершённой
  - Обновить индикатор прогресса
  - Очистить решённые блокеры
  - Обновить дату ссылки на проект

</lifecycle>

<sections>

### Ссылка на проект
Указывает на PROJECT.md для полного контекста. Включает:
- Ключевую ценность (ОДНА вещь, которая важна)
- Текущий фокус (какая фаза)
- Дата последнего обновления (инициирует повторное чтение при устаревании)

Claude читает PROJECT.md напрямую для требований, ограничений и решений.

### Текущая позиция
Где мы сейчас:
- Фаза X из Y — какая фаза
- План A из B — какой план внутри фазы
- Статус — текущее состояние
- Последняя активность — что произошло совсем недавно
- Индикатор прогресса — визуальный показатель общего завершения

Расчёт прогресса: (завершённые планы) / (всего планов по всем фазам) × 100%

### Метрики производительности
Отслеживание скорости для понимания паттернов выполнения:
- Всего завершённых планов
- Средняя длительность на план
- Разбивка по фазам
- Последний тренд (улучшается/стабильный/ухудшается)

Обновляется после завершения каждого плана.

### Накопленный контекст

**Решения:** Ссылка на таблицу Ключевых решений PROJECT.md, плюс краткое описание последних решений для быстрого доступа. Полный журнал решений хранится в PROJECT.md.

**Отложенные задачи:** Идеи, зафиксированные через /gsd:add-todo
- Количество отложенных задач
- Ссылка на .planning/todos/pending/
- Краткий список если мало, количество если много (напр. "5 отложенных задач — см. /gsd:check-todos")

**Блокеры/Проблемы:** Из разделов "Готовность к следующей фазе"
- Вопросы, влияющие на будущую работу
- Префикс с фазой-источником
- Очищаются при решении

### Непрерывность сессий
Обеспечивает мгновенное возобновление:
- Когда была последняя сессия
- Что было последним завершённым действием
- Есть ли файл .continue-here для возобновления

</sections>

<size_constraint>

Держите STATE.md менее 100 строк.

Это ДАЙДЖЕСТ, не архив. Если накопленный контекст разрастается:
- Оставляйте только 3-5 последних решений в кратком описании (полный журнал в PROJECT.md)
- Оставляйте только активные блокеры, убирайте решённые

Цель — "прочитал один раз, знаю где мы" — если файл слишком длинный, это не работает.

</size_constraint>
